
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RH Master - Sistema Standalone</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FFB100;
            color: #111827;
            margin: 0;
            overflow-x: hidden;
        }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #FFB100; }
        ::-webkit-scrollbar-thumb { background: #d99600; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #bf8400; }
        
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@19.0.0",
    "react-dom": "https://esm.sh/react-dom@19.0.0",
    "react-dom/client": "https://esm.sh/react-dom@19.0.0/client",
    "lucide-react": "https://esm.sh/lucide-react@0.463.0?external=react,react-dom",
    "recharts": "https://esm.sh/recharts@2.13.3?external=react,react-dom",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/",
    "react/": "https://esm.sh/react@^19.2.4/",
    "@supabase/supabase-js": "https://esm.sh/@supabase/supabase-js@^2.93.3"
  }
}
</script>
</head>
<body>
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            LayoutDashboard, UserPlus, FileText, Users, History, Menu, X, Wallet, 
            Search, Eye, HandCoins, Layers, MapPin, FileDigit, Briefcase, 
            DollarSign, User, Pencil, Save, RotateCcw, RefreshCw, LogOut,
            TrendingUp, CreditCard, Activity, AlertCircle, FileDown, Calculator,
            PlusCircle, MinusCircle, CheckCircle2, MessageSquare, Info, Trash2, Building2
        } from 'lucide-react';
        import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Cell } from 'recharts';

        // --- DADOS FICTÍCIOS (MOCK DATA) ---
        const INITIAL_EMPLOYEES = [
            { id: '1', name: 'Jairo de Andrea Pesseti', company: 'CAMPLUVAS', admissionDate: '01/01/2020', role: 'Gerente de Produção', salary: 5500, roleAccumulation: 500, cpf: '123.456.789-00', rg: '12.345.678-9', address: 'Rua das Flores, 123', city: 'São Paulo', state: 'SP', phone: '(11) 98888-7777', birthDate: '15/05/1985', fatherName: 'Antonio Pesseti', motherName: 'Maria de Andrea', pis: '123.45678.90-1', ctps: '9876543-001', voterId: '123456789012' },
            { id: '2', name: 'Ana Beatriz Silva', company: 'LOCATEX', admissionDate: '15/03/2021', role: 'Analista Administrativo', salary: 3800, roleAccumulation: 0, cpf: '222.333.444-55', rg: '22.333.444-x', address: 'Av. Paulista, 1000', city: 'São Paulo', state: 'SP', phone: '(11) 97777-6666', birthDate: '20/10/1992', fatherName: 'Carlos Silva', motherName: 'Elena Silva', pis: '222.33333.44-5', ctps: '1112223-002', voterId: '222233334444' },
            { id: '3', name: 'Roberto Santos', company: 'CAMPLUVAS', admissionDate: '10/06/2019', role: 'Operador Especializado', salary: 2900, roleAccumulation: 200, cpf: '333.444.555-66', rg: '33.444.555-1', address: 'Rua B, 45', city: 'Guarulhos', state: 'SP', phone: '(11) 96666-5555', birthDate: '05/02/1980', fatherName: 'José Santos', motherName: 'Ana Santos', pis: '333.44444.55-6', ctps: '3334445-003', voterId: '333344445555' }
        ];

        const INITIAL_PAYROLL = [
            { id: 'p1', employeeId: '1', closingDate: '05/10/2023', otherIncome: 100, bonuses: 200, vt: true, basicBasket: 150, ot100: 5, ot70: 0, ot50: 10, vr: 400, advances: 2200, absences: 0, loans: 0, pharmacy: 50, supermarket: 300, dental: 0, medical: 0, otherConvenios: 0, otherDiscounts: 0, observations: 'Fechamento padrão.' }
        ];

        // --- COMPONENTES ---

        const DetailItem = ({ label, value, icon, name, isEditing, onChange, type = "text" }) => (
            <div className="flex flex-col gap-1 p-3 bg-gray-50 rounded-xl border border-gray-200 hover:border-blue-400 transition-colors">
                <div className="flex items-center gap-2">
                    {icon && <span className="text-gray-400">{icon}</span>}
                    <span className="text-[10px] font-black text-gray-500 uppercase tracking-widest">{label}</span>
                </div>
                {isEditing && name ? (
                    <input 
                        type={type} name={name} value={value} onChange={onChange} step={type === 'number' ? '0.01' : undefined}
                        className="bg-white text-sm font-bold text-gray-900 border border-blue-500/30 rounded px-2 py-1 focus:outline-none focus:border-blue-500 w-full"
                    />
                ) : (
                    <span className="text-sm font-bold text-gray-900 truncate">
                        {type === 'number' && typeof value === 'number' ? value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' }) : (value || '---')}
                    </span>
                )}
            </div>
        );

        const Dashboard = ({ employees, setActiveView }) => {
            const totalSalaries = employees.reduce((acc, curr) => acc + curr.salary, 0);
            const salaryData = employees.sort((a, b) => b.salary - a.salary).slice(0, 5).map(e => ({ name: e.name.split(' ')[0], salary: e.salary }));
            
            return (
                <div className="space-y-8 fade-in">
                    <header className="flex justify-between items-center">
                        <div>
                            <h1 className="text-4xl font-black tracking-tighter text-gray-900">Visão Geral</h1>
                            <p className="text-gray-600 font-medium">Bem-vindo ao centro de controle local.</p>
                        </div>
                        <button onClick={() => setActiveView('PAYROLL')} className="bg-gray-900 hover:bg-black text-white font-black py-3 px-6 rounded-2xl transition-all shadow-xl">Novo Lançamento</button>
                    </header>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div className="bg-white p-6 rounded-3xl shadow-lg border border-gray-100">
                            <Users className="text-blue-600 mb-4" size={24} />
                            <p className="text-gray-400 text-xs font-black uppercase tracking-widest">Colaboradores</p>
                            <p className="text-2xl font-black">{employees.length}</p>
                        </div>
                        <div className="bg-white p-6 rounded-3xl shadow-lg border border-gray-100">
                            <CreditCard className="text-green-600 mb-4" size={24} />
                            <p className="text-gray-400 text-xs font-black uppercase tracking-widest">Folha Base</p>
                            <p className="text-2xl font-black">{totalSalaries.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</p>
                        </div>
                        <div className="bg-white p-6 rounded-3xl shadow-lg border border-gray-100">
                            <Activity className="text-yellow-600 mb-4" size={24} />
                            <p className="text-gray-400 text-xs font-black uppercase tracking-widest">Empresas</p>
                            <p className="text-2xl font-black">2</p>
                        </div>
                    </div>
                    <div className="bg-white p-8 rounded-3xl shadow-lg border border-gray-100 h-[350px]">
                        <h3 className="text-xl font-black mb-6">Maiores Salários</h3>
                        <ResponsiveContainer width="100%" height="80%">
                            <BarChart data={salaryData}>
                                <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f3f4f6" />
                                <XAxis dataKey="name" axisLine={false} tickLine={false} fontSize={12} fontStyle="bold" />
                                <YAxis axisLine={false} tickLine={false} fontSize={10} />
                                <Tooltip cursor={{fill: '#f9fafb'}} contentStyle={{borderRadius: '12px', border: 'none', boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)'}} />
                                <Bar dataKey="salary" fill="#111827" radius={[10, 10, 0, 0]} />
                            </BarChart>
                        </ResponsiveContainer>
                    </div>
                </div>
            );
        };

        const EmployeeList = ({ employees, onSelect }) => (
            <div className="space-y-6 fade-in">
                <h1 className="text-3xl font-black text-gray-900">Colaboradores</h1>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {employees.map(emp => (
                        <div key={emp.id} className="bg-white p-6 rounded-[2rem] border border-gray-100 shadow-lg hover:border-gray-900 transition-all flex flex-col justify-between group">
                            <div>
                                <div className="flex justify-between items-start mb-2">
                                    <h3 className="font-black text-xl">{emp.name}</h3>
                                    <span className="text-[10px] bg-blue-100 text-blue-600 px-2 py-1 rounded-full font-black uppercase">{emp.company}</span>
                                </div>
                                <p className="text-xs font-bold text-gray-400 uppercase tracking-widest">{emp.role}</p>
                            </div>
                            <button onClick={() => onSelect(emp)} className="mt-4 py-3 bg-gray-50 rounded-xl text-xs font-black uppercase flex items-center justify-center gap-2 hover:bg-gray-900 hover:text-white transition-all">
                                <Eye size={14} /> Detalhes
                            </button>
                        </div>
                    ))}
                </div>
            </div>
        );

        const App = () => {
            const [view, setView] = useState('DASHBOARD');
            const [employees, setEmployees] = useState(INITIAL_EMPLOYEES);
            const [payroll, setPayroll] = useState(INITIAL_PAYROLL);
            const [isSidebarOpen, setIsSidebarOpen] = useState(true);
            const [selectedEmp, setSelectedEmp] = useState(null);

            const menu = [
                { id: 'DASHBOARD', label: 'Dashboard', icon: <LayoutDashboard size={20} /> },
                { id: 'EMPLOYEES', label: 'Funcionários', icon: <Users size={20} /> },
                { id: 'PAYROLL', label: 'Folha de Pagamento', icon: <FileText size={20} /> },
                { id: 'ADVANCES', label: 'Adiantamentos', icon: <HandCoins size={20} /> },
            ];

            return (
                <div className="min-h-screen flex bg-[#FFB100]">
                    {/* Sidebar */}
                    <aside className={`${isSidebarOpen ? 'w-64' : 'w-20'} transition-all duration-300 bg-white border-r border-gray-100 fixed h-full z-50 shadow-2xl flex flex-col`}>
                        <div className="p-6 flex items-center justify-between border-b border-gray-50">
                            <div className={`flex items-center gap-3 ${!isSidebarOpen && 'hidden'}`}>
                                <div className="bg-gray-900 p-2 rounded-xl text-[#FFB100]"><Wallet size={20} /></div>
                                <span className="font-black text-lg">RH Master</span>
                            </div>
                            <button onClick={() => setIsSidebarOpen(!isSidebarOpen)} className="p-1 hover:bg-gray-100 rounded-lg"><Menu size={20} /></button>
                        </div>
                        <nav className="flex-1 p-3 space-y-2 mt-4">
                            {menu.map(item => (
                                <button key={item.id} onClick={() => setView(item.id)} className={`w-full flex items-center gap-3 px-4 py-3 rounded-2xl font-black text-sm transition-all ${view === item.id ? 'bg-gray-900 text-white shadow-xl' : 'text-gray-400 hover:bg-gray-100'}`}>
                                    {item.icon} {isSidebarOpen && <span>{item.label}</span>}
                                </button>
                            ))}
                        </nav>
                        <div className="p-6 border-t border-gray-50 text-center">
                            <p className="text-[10px] font-black text-gray-300 uppercase tracking-widest">Versão Standalone</p>
                        </div>
                    </aside>

                    {/* Main Content */}
                    <main className={`flex-1 transition-all duration-300 ${isSidebarOpen ? 'ml-64' : 'ml-20'} p-10`}>
                        {view === 'DASHBOARD' && <Dashboard employees={employees} setActiveView={setView} />}
                        {view === 'EMPLOYEES' && <EmployeeList employees={employees} onSelect={setSelectedEmp} />}
                        {view === 'PAYROLL' && (
                            <div className="fade-in">
                                <h1 className="text-3xl font-black mb-6">Lançar Folha Individual</h1>
                                <div className="bg-white p-8 rounded-[2.5rem] shadow-xl border border-gray-100">
                                    <p className="text-gray-400 font-bold mb-4 uppercase text-xs tracking-widest">Selecione o funcionário e preencha os campos abaixo.</p>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <select className="bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 font-bold">
                                            {employees.map(e => <option key={e.id}>{e.name}</option>)}
                                        </select>
                                        <input type="text" placeholder="Data (DD/MM/AAAA)" className="bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 font-bold" />
                                    </div>
                                    <div className="mt-8 pt-8 border-t border-gray-50 flex justify-end">
                                        <button className="bg-gray-900 text-white px-8 py-3 rounded-xl font-black hover:bg-black transition-all shadow-lg">Salvar Lançamento</button>
                                    </div>
                                </div>
                            </div>
                        )}
                        {view === 'ADVANCES' && (
                            <div className="fade-in">
                                <h1 className="text-3xl font-black mb-6">Adiantamentos (40%)</h1>
                                <div className="bg-white rounded-[2.5rem] shadow-xl overflow-hidden border border-gray-100">
                                    <table className="w-full text-left">
                                        <thead className="bg-gray-50 text-[10px] font-black uppercase text-gray-400 tracking-widest">
                                            <tr>
                                                <th className="px-8 py-4">Colaborador</th>
                                                <th className="px-8 py-4 text-right">Salário Base</th>
                                                <th className="px-8 py-4 text-right">40% Calculado</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-50">
                                            {employees.map(e => (
                                                <tr key={e.id} className="hover:bg-gray-50 transition-colors">
                                                    <td className="px-8 py-4 font-black">{e.name}</td>
                                                    <td className="px-8 py-4 text-right font-mono">{e.salary.toLocaleString('pt-BR', {style: 'currency', currency:'BRL'})}</td>
                                                    <td className="px-8 py-4 text-right font-mono text-blue-600 font-bold">{(e.salary * 0.4).toLocaleString('pt-BR', {style: 'currency', currency:'BRL'})}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}
                    </main>

                    {/* Employee Detail Modal */}
                    {selectedEmp && (
                        <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-gray-900/60 backdrop-blur-md fade-in">
                            <div className="bg-white border border-gray-100 w-full max-w-4xl rounded-[2.5rem] overflow-hidden flex flex-col max-h-[90vh] shadow-2xl">
                                <div className="p-8 border-b border-gray-50 flex justify-between items-center bg-gray-50">
                                    <div>
                                        <h2 className="text-3xl font-black text-gray-900">{selectedEmp.name}</h2>
                                        <span className="text-xs text-blue-600 font-black uppercase tracking-widest">{selectedEmp.company} • {selectedEmp.role}</span>
                                    </div>
                                    <button onClick={() => setSelectedEmp(null)} className="p-3 hover:bg-red-50 text-gray-400 hover:text-red-600 rounded-xl transition-all"><X size={24} /></button>
                                </div>
                                <div className="p-8 overflow-y-auto space-y-10">
                                    <section>
                                        <h3 className="text-[10px] font-black uppercase tracking-[0.2em] text-gray-400 mb-4">Informações Pessoais</h3>
                                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                            <DetailItem label="CPF" value={selectedEmp.cpf} />
                                            <DetailItem label="RG" value={selectedEmp.rg} />
                                            <DetailItem label="Nascimento" value={selectedEmp.birthDate} />
                                        </div>
                                    </section>
                                    <section>
                                        <h3 className="text-[10px] font-black uppercase tracking-[0.2em] text-gray-400 mb-4">Filiação e Documentos</h3>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <DetailItem label="Pai" value={selectedEmp.fatherName} />
                                            <DetailItem label="Mãe" value={selectedEmp.motherName} />
                                            <DetailItem label="PIS" value={selectedEmp.pis} />
                                            <DetailItem label="CTPS" value={selectedEmp.ctps} />
                                        </div>
                                    </section>
                                    <section className="bg-gray-50 p-6 rounded-3xl border border-gray-100">
                                        <h3 className="text-xs font-black uppercase text-gray-900 mb-4">Remuneração Base</h3>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <DetailItem label="Salário" value={selectedEmp.salary} type="number" />
                                            <DetailItem label="Acúmulo" value={selectedEmp.roleAccumulation} type="number" />
                                        </div>
                                    </section>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const container = document.getElementById('root');
        const root = createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
